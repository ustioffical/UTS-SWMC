{% extends "master.html" %}
{% load static %}

{% block title %}Vehicle{% endblock %}

<!-- Custom Plugins CSS -->
{% block PluginsCSS %}
    <link rel="stylesheet" type="text/css" href="{% static "assets/css/vendors/jquery.dataTables.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "assets/css/vendors/select.bootstrap5.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "assets/css/vendors/sweetalert2.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "assets/css/vendors/select/bootstrap-select.min.css" %}">
{% endblock %}
<!--End Custom Plugins CSS -->

{% block LeafletLink %}
    <!--Google Key-->
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDyN4NVgaHV6-AbuAdWqSBM07iay6gbfKc&libraries=places"></script>

    <!--leaflet js library style link -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
          integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
          crossorigin=""/>
    <link rel="stylesheet"
          href="{% static 'assets/script/jslib/leaflet/plugins/PolylineMeasure/Leaflet.PolylineMeasure.css' %}"/>
    <link rel="stylesheet"
          href="{% static 'assets/script/jslib/leaflet/plugins/styledLayerControl/styledLayerControl.css' %}"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"/>
{% endblock %}

{% block link %}
    <link rel="stylesheet" type="text/css" href="{% static "assets/app_css/GetColor-Tooltip-Vehicle.css" %}">
{% endblock %}

{% block css %}

    .default-map-js-height{
    height: 605px;
    }

    .filter-companies .accordion-item {
    border: 1px solid #e9edf1;
    }

    .main-file-sidebar .md-sidebar .md-sidebar-aside .common-sort-card .files-left-icons li a svg {
    width: 24px;
    height: 24px;
    }

    .border-tb-l-radius {
    border-top-left-radius: 5px !important;
    border-bottom-left-radius: 5px !important;
    }

    .main-file-sidebar .md-sidebar .md-sidebar-aside .common-sort-card .files-left-icons li {
    margin-bottom: 10px;
    }

    .main-file-sidebar .md-sidebar .md-sidebar-aside .common-sort-card .files-left-icons li a {
    padding: 6px 10px
    }

    .common-space {
    justify-content: normal;
    }

    .course-box .card-body {
    padding: 10px 15px;
    }

{% endblock %}

<!-- Header Page Hierarchy-->
{% block breadcrumb %}
    <div class="container-fluid">
        <div class="page-title">
            <div class="row">
                <div class="col-sm-6">
                    {#        <h3>{{breadcrumb.title}} </h3>#}
                    <h3>Vehicle Monitoring System</h3>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/index">
                            <svg class="stroke-icon">
                                <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-home"></use>
                            </svg>
                        </a></li>
                        {#          <li class="breadcrumb-item">{{breadcrumb.parent}}</li>#}
                        <li class="breadcrumb-item">Vehicle</li>
                        <li class="breadcrumb-item active">Monitoring</li>
                        {#          <li class="breadcrumb-item active">{{breadcrumb.child}}</li>#}
                    </ol>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
<!-- Header Page Hierarchy-->

{% block content %}

    <!-- Container-fluid starts-->
    <div class="container-fluid main-companies">

        <div class="row general-widget-wrapper">

            <style>
                .course-box .card-body {
                    padding: 10px 5px;
                }
            </style>

            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon all">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_total_vehicle">0</span>
                                </h4>
                                <span class="f-light">Total Vehicle</span>
                                <a class="btn btn-light f-light m-t-10" href="javaScript:void(0)">
                                    View List
                                    <span class="ms-2">
                                    <svg class="fill-icon f-light">
                                        <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                    </svg>
                                </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon success">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_moving_vehicle">0</span>
                                </h4>
                                <span class="f-light">Moving Vehicle</span>
                                <a class="btn btn-light f-light m-t-10"
                                   href="javaScript:void(0)">
                                    View List
                                    <span class="ms-2">
                                    <svg class="fill-icon f-light">
                                        <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                    </svg>
                                </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon info">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_idle_vehicle">0</span>
                                </h4>
                                <span class="f-light">Idle Vehicle</span>
                                <a class="btn btn-light f-light m-t-10"
                                   href="javaScript:void(0)">
                                    View List
                                    <span class="ms-2">
                                        <svg class="fill-icon f-light">
                                            <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                        </svg>
                                    </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon warning">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_stop_park_vehicle">0</span>
                                </h4>
                                <span class="f-light">Vehicle Stop/Park</span>
                                <a class="btn btn-light f-light m-t-10"
                                   href="{% url 'AllVehicleMonitoring' %}?status=Parked">
                                    View List
                                    <span class="ms-2">
                                        <svg class="fill-icon f-light">
                                            <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                        </svg>
                                    </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon light">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_offline_vehicle">0</span>
                                </h4>
                                <span class="f-light">Vehicle Offline</span>
                                <a class="btn btn-light f-light m-t-10"
                                   href="javaScript:void(0)">
                                    View List
                                    <span class="ms-2">
                                        <svg class="fill-icon f-light">
                                            <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                        </svg>
                                    </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>
            <div class="col-xs-12 col-sm-6 col-md-4 col-xl-2 col-lg-4 box-col-2">
                <div class="card course-box">
                    <div class="card-body">
                        <div class="course-widget">
                            <div class="course-icon">
                                <svg class="fill-icon">
                                    <use href="{% static 'assets/svg/icon-sprite.svg' %}#stroke-progress-delivery"></use>
                                </svg>
                            </div>
                            <div>
                                <h4 class="mb-0">
                                    <span class="counter" id="summary_violation_vehicle">0</span>
                                </h4>
                                <span class="f-light">Stop Violation</span>
                                {#                                You can edit this according to your req in db#}
                                <a class="btn btn-light f-light m-t-10"
                                   href="javaScript:void(0)">
                                    View List
                                    <span class="ms-2">
                                        <svg class="fill-icon f-light">
                                            <use href="{% static 'assets/svg/icon-sprite.svg' %}#arrowright"></use>
                                        </svg>
                                    </span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <ul class="square-group">
                        <li class="square-1 warning"></li>
                        <li class="square-1 primary"></li>
                        <li class="square-2 warning1"></li>
                        <li class="square-3 danger"></li>
                        <li class="square-4 light"></li>
                        <li class="square-5 warning"></li>
                        <li class="square-6 success"></li>
                        <li class="square-7 success"></li>
                    </ul>
                </div>
            </div>

            <script>
                let vehicle_moving = 0;
                let vehicle_idle = 0;
                let vehicle_stop_park = 0;
                let vehicle_offline = 0;
                let vehicle_total = 0;
            </script>
            {% for data in vehicle_g_status %}
                <script>
                    var vehicle_g_status = '{{ data.g_status }}';
                    if (vehicle_g_status === "Moving") {
                        vehicle_moving = parseInt({{ data.count }});
                    } else if (vehicle_g_status === "Idle") {
                        vehicle_idle = parseInt({{ data.count }});
                    } else if (vehicle_g_status === "Parked") {
                        vehicle_stop_park = parseInt({{ data.count }});
                    } else if (vehicle_g_status === "Offline") {
                        vehicle_offline = parseInt({{ data.count }});
                    }
                    vehicle_total += parseInt({{ data.count }});
                </script>
            {% endfor %}

            <script>
                document.getElementById("summary_total_vehicle").innerHTML = vehicle_total.toLocaleString();
                document.getElementById("summary_moving_vehicle").innerHTML = vehicle_moving.toLocaleString();
                document.getElementById("summary_idle_vehicle").innerHTML = vehicle_idle.toLocaleString();
                document.getElementById("summary_stop_park_vehicle").innerHTML = vehicle_stop_park.toLocaleString();
                document.getElementById("summary_offline_vehicle").innerHTML = vehicle_offline.toLocaleString();
            </script>

        </div>

        <div class="row">

            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12 col-xl-5 box-col-12">
                <div class="md-sidebar"><a class="btn btn-primary email-aside-toggle md-sidebar-toggle">Filters</a>
                    <div class="md-sidebar-aside job-sidebar custom-scrollbar">
                        <div class="card">
                            <div class="card-header">
                                <div class="header-top"><h5>Vehicle Analysis</h5></div>
                            </div>
                            <div class="card-body filter-companies">

                                <style>
                                    .crm-card .card-body p {
                                        margin-bottom: 10px;
                                    }

                                    .crm-card .crm-img {
                                        height: 80px;
                                    }
                                </style>

                                <div class="col-md-12">
                                    <div class="card-wrapper border rounded-3 mb-2" style="padding: 5px;">

                                        <div class="header-top bg-opacity-wrapper">

                                            <div class="p-1 text-dark bg-opacity-25 rounded-pill">
                                                <div class="d-flex">
                                                    <div class="text-end icon-state">
                                                        <label class="switch mb-0">
                                                            <input type="checkbox" value="ck_vehicle_monitoring"
                                                                   id="ck_vehicle_monitoring"
                                                                   onchange="MappingModelJS.OnclickVehicleLiveMonitoring_Map(this.value, '{{ selected_vehicle_status }}', '{{ selected_vehicle_type }}', '{{ selected_vehicle_code }}')">
                                                            <span class="switch-state bg-success"></span>
                                                        </label>
                                                    </div>
                                                    <label class="col-form-label m-l-5 m-r-10 f-w-500 Font-size f-16">
                                                        Live Monitoring
                                                    </label>
                                                </div>
                                            </div>

                                            <div class="form-check checkbox checkbox-primary ps-0 main-icon-checkbox">
                                                <ul class="checkbox-wrapper">
                                                    <li style="padding: 8px;">
                                                        <input class="form-check-input checkbox-shadow"
                                                               id="vehicle_live_label" name="vehicle_live_label"
                                                               type="checkbox">
                                                        <label class="form-check-label" for="vehicle_live_label">
                                                            <i id="vehicle_live_label_i"
                                                               class="fa-solid fa-eye-slash"></i>
                                                            <span>Lebal</span></label>
                                                    </li>
                                                </ul>
                                            </div>

                                        </div>

                                    </div>
                                </div>

                                <div class="col-md-12">
                                    <div class="card o-hidden crm-card mb-2">
                                        <div class="card-body p-10">
                                            <h4 class="mb-0 f-w-500">Vehicle Sync</h4>
                                            <p class="mb-0 w-100">Installation of new tracker device in vehicle
                                                then...</p>
                                            <a class="btn btn-info"
                                               href="{% url 'AllVehicleSync' %}">
                                                <i class="fa-solid fa-arrows-rotate me-1"></i>
                                                Sync New Vehicle
                                                <span class="badge text-bg-warning ms-2">{{ api_vehicle_diff }}</span>
                                            </a>
                                        </div>
                                        <img class="crm-img" src="{% static 'assets/images/dashboard-9/widget.svg' %}"
                                             alt="search image">
                                    </div>
                                </div>

                                <div class="col-md-12">
                                    <div class="accordion" id="accordionExample">

                                        <!-- LAYER INFORMATION -->
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button"
                                                        data-bs-toggle="collapse"
                                                        data-bs-target="#collapseLayer" aria-expanded="true"
                                                        aria-controls="collapseLayer">
                                                    Layer Information
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="feather feather-chevron-down svg-color">
                                                        <polyline points="6 9 12 15 18 9"></polyline>
                                                    </svg>
                                                </button>
                                            </h2>

                                            <div class="accordion-collapse collapse" id="collapseLayer">
                                                <div class="accordion-body">

                                                    <div class="col-xl-12 box-col-12 pe-0 xl-12 main-file-sidebar">
                                                        <div class="md-sidebar">
                                                            <div class="md-sidebar-aside job-left-aside custom-scrollbar">
                                                                <div class="file-sidebar">
                                                                    <div class="card">
                                                                        <div class="common-sort-card p-0">

                                                                            <ul class="files-left-icons file-type-icons">

                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_container_layer"
                                                                                                           value="asset_container_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                            <img class="img-fluid for-light"
                                                                                                 src="/static/assets/images/legend/container/to_be_visited.png"
                                                                                                 alt=""
                                                                                                 style="width: 24px; height: 24px;">
                                                                                        </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Container</span>
                                                                                        </div>
                                                                                        <span>
                                                                                        <button class="btn border-dashed-primary"
                                                                                                id="view_container_count"
                                                                                                style="padding: 0.05rem 0.565rem;">
                                                                                        </button>
                                                                                    </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_drum_layer"
                                                                                                           value="asset_drum_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                            <img class="img-fluid for-light"
                                                                                                 src="/static/assets/images/legend/drum/to_be_visited.png"
                                                                                                 alt=""
                                                                                                 style="width: 24px; height: 24px;">
                                                                                        </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Drum</span>
                                                                                        </div>
                                                                                        <span>
                                                                                        <button class="btn border-dashed-primary"
                                                                                                id="view_drum_count"
                                                                                                style="padding: 0.05rem 0.565rem;">0</button>
                                                                                    </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_collection_site_layer"
                                                                                                           value="asset_collection_site_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                                <img class="img-fluid for-light"
                                                                                                     src="{% static 'assets/images/legend/asset_logo/collection_site.png' %}"
                                                                                                     alt=""
                                                                                                     style="width: 24px; height: 24px;">
                                                                                            </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Collection Sites</span>
                                                                                        </div>
                                                                                        <span>
                                                                                            <button class="btn border-dashed-primary"
                                                                                                    id="view_tcs_count"
                                                                                                    style="padding: 0.05rem 0.565rem;">0</button>
                                                                                        </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_dumping_site_layer"
                                                                                                           value="asset_dumping_site_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                                <img class="img-fluid for-light"
                                                                                                     src="{% static 'assets/images/legend/asset_logo/dumping_site.png' %}"
                                                                                                     alt=""
                                                                                                     style="width: 24px; height: 24px;">
                                                                                            </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Dumping Sites</span>
                                                                                        </div>
                                                                                        <span>
                                                                                            <button class="btn border-dashed-primary"
                                                                                                    id="view_dump_site_count"
                                                                                                    style="padding: 0.05rem 0.565rem;">0</button>
                                                                                        </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_weighing_site_layer"
                                                                                                           value="asset_weighing_site_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                                <img class="img-fluid for-light"
                                                                                                     src="{% static 'assets/images/legend/asset_logo/weighing-machine.png' %}"
                                                                                                     alt=""
                                                                                                     style="width: 24px; height: 24px;">
                                                                                            </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Weighing</span>
                                                                                        </div>
                                                                                        <span>
                                                                                            <button class="btn border-dashed-primary"
                                                                                                    id="view_dump_site_count"
                                                                                                    style="padding: 0.05rem 0.565rem;">1</button>
                                                                                        </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_landuse_boundary_layer"
                                                                                                           value="asset_landuse_boundary_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                                <img class="img-fluid for-light"
                                                                                                     src="{% static 'assets/images/legend/asset_logo/union_council.png' %}"
                                                                                                     alt=""
                                                                                                     style="width: 24px; height: 24px;">
                                                                                            </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Landuse Boundary</span>
                                                                                        </div>
                                                                                        <span>
                                                                                            <button class="btn border-dashed-primary"
                                                                                                    id="view_landuse_count"
                                                                                                    style="padding: 0.05rem 0.565rem;">0</button>
                                                                                        </span>
                                                                                    </a>
                                                                                </li>
                                                                                <li class="border-left-primary border-tb-l-radius m-b-5">
                                                                                    <a id="folder-files-tab"
                                                                                       href="javaScript:void(0)">
                                                                                        <div>
                                                                                            <div class="form-check-size default-square radius-none">
                                                                                                <div class="form-check form-switch form-check-inline">
                                                                                                    <input class="form-check-input switch-primary check-size"
                                                                                                           type="checkbox"
                                                                                                           id="asset_admin_boundary_layer"
                                                                                                           value="asset_admin_boundary_layer"
                                                                                                           onchange="DigitalArzModelJS.OnclickAssetLayer_TOC(this.value)"
                                                                                                           role="switch">
                                                                                                </div>
                                                                                            </div>
                                                                                            <span>
                                                                                                <img class="img-fluid for-light"
                                                                                                     src="{% static 'assets/images/legend/asset_logo/union_council.png' %}"
                                                                                                     alt=""
                                                                                                     style="width: 24px; height: 24px;">
                                                                                            </span>
                                                                                            <span class="f-16 txt-primary p-t-5">Administrative Boundary</span>
                                                                                        </div>
                                                                                        <span>
                                                                                            <button class="btn border-dashed-primary"
                                                                                                    id="view_admin_count"
                                                                                                    style="padding: 0.05rem 0.565rem;">0</button>
                                                                                        </span>
                                                                                    </a>
                                                                                </li>

                                                                                {% for data in asset_type_summary %}
                                                                                    <script>
                                                                                        var asset_name = '{{ data.name }}';
                                                                                        var asset_value = parseInt({{ data.value }})
                                                                                        if (asset_name === "Container") {
                                                                                            document.getElementById("view_container_count").innerHTML = asset_value.toLocaleString();
                                                                                        } else if (asset_name === "Drum") {
                                                                                            document.getElementById("view_drum_count").innerHTML = asset_value.toLocaleString();
                                                                                        } else if (asset_name === "Collection-Site") {
                                                                                            document.getElementById("view_tcs_count").innerHTML = asset_value.toLocaleString();
                                                                                        } else if (asset_name === "Dumping-Site") {
                                                                                            document.getElementById("view_dump_site_count").innerHTML = asset_value.toLocaleString();
                                                                                        } else if (asset_name === "Landuse") {
                                                                                            document.getElementById("view_landuse_count").innerHTML = asset_value.toLocaleString();
                                                                                        } else if (asset_name === "Admin") {
                                                                                            document.getElementById("view_admin_count").innerHTML = asset_value.toLocaleString();
                                                                                        }
                                                                                    </script>
                                                                                {% endfor %}

                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <!-- LAYER INFORMATION -->

                                        <!-- FILTER INFORMATION -->
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button" type="button"
                                                        data-bs-toggle="collapse"
                                                        data-bs-target="#collapseFilter" aria-expanded="true"
                                                        aria-controls="collapseFilter">
                                                    Filter
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                         viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                         stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                         class="feather feather-chevron-down svg-color">
                                                        <polyline points="6 9 12 15 18 9"></polyline>
                                                    </svg>
                                                </button>
                                            </h2>
                                            <div class="accordion-collapse" id="collapseFilter" style="">
                                                <div class="accordion-body">

                                                    <div class="card-body filter-cards-view animate-chk p-0">

                                                        {#                                                        <div class="job-filter mb-2">#}
                                                        {#                                                            <div class="faq-form">#}
                                                        {#                                                                <form method="GET"#}
                                                        {#                                                                      action="{% url 'AllVehicleMonitoring' %}"#}
                                                        {#                                                                      class="d-flex">#}
                                                        {#                                                                    <input class="form-control" type="text"#}
                                                        {#                                                                           id="vehicle_search" name="vehicle_search"#}
                                                        {#                                                                           placeholder="Search By Vehicle Code..."#}
                                                        {#                                                                           value="{{  }}">#}
                                                        {#                                                                    <button type="submit" class="btn btn-primary ms-2">#}
                                                        {#                                                                        <i class="fa fa-search"></i>#}
                                                        {#                                                                    </button>#}
                                                        {#                                                                    {% if  %}#}
                                                        {#                                                                        <a href="{% url 'AllVehicleMonitoring' %}"#}
                                                        {#                                                                           class="btn btn-light ms-2">#}
                                                        {#                                                                            <i class="fa fa-times"></i>#}
                                                        {#                                                                        </a>#}
                                                        {#                                                                    {% endif %}#}
                                                        {#                                                                </form>#}
                                                        {#                                                            </div>#}
                                                        {#                                                        </div>#}

                                                        <form class="form form-horizontal" action=""
                                                              method="post" accept-charset='utf-8'
                                                              enctype="multipart/form-data">

                                                            {% csrf_token %}
                                                            <div class="row mb-3">
                                                                <label class="col-md-4 form-label pt-1 fw-bolder">
                                                                    Vehicle Status:
                                                                </label>
                                                                <div class="col-md-8">
                                                                    <select id="cmd_vehicle_status"
                                                                            name="cmd_vehicle_status"
                                                                            class="selectpicker"
                                                                            data-live-search="true">
                                                                        <option value="NA">
                                                                            Choose One
                                                                        </option>
                                                                        {% for status in vehicle_g_status %}
                                                                            <option value="{{ status.g_status }}"
                                                                                    {% if selected_vehicle_status == status.g_status %}selected{% endif %}>
                                                                                {{ status.g_status }} -
                                                                                ({{ status.count }})
                                                                            </option>
                                                                        {% endfor %}
                                                                    </select>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-3">
                                                                <label class="col-md-4 form-label pt-1 fw-bolder">
                                                                    Vehicle Type:
                                                                </label>
                                                                <div class="col-md-8">
                                                                    <select id="cmd_vehicle_type"
                                                                            name="cmd_vehicle_type" class="selectpicker"
                                                                            data-live-search="true">
                                                                        <option value="NA">
                                                                            Choose One
                                                                        </option>
                                                                        {% for type in vehicle_type_list %}
                                                                            <option value="{{ type.vehicle_type }}"
                                                                                    {% if selected_vehicle_type == type.vehicle_type %}selected{% endif %}>
                                                                                {{ type.vehicle_type }} -
                                                                                ({{ type.count }})
                                                                            </option>
                                                                        {% endfor %}
                                                                    </select>
                                                                </div>
                                                            </div>

                                                            <div class="row mb-3">
                                                                <label class="col-md-4 form-label fw-bolder pt-1">
                                                                    Vehicle ID:
                                                                </label>
                                                                <div class="col-md-8">
                                                                    <select id="cmd_vehicle_list"
                                                                            name="cmd_vehicle_list" class="selectpicker"
                                                                            data-live-search="true" data-size="10">
                                                                        <option value="NA"
                                                                                {% if not selected_vehicle_code %}selected{% endif %}>
                                                                            Choose One
                                                                        </option>
                                                                        {% for vehicle in vehicle_data_list %}
                                                                            <option value="{{ vehicle.vehicle_code }}"
                                                                                    {% if selected_vehicle_code == vehicle.vehicle_code %}selected{% endif %}>
                                                                                {% if vehicle.register_no == "APL-4" %}
                                                                                    {{ vehicle.chasis_no }}
                                                                                {% else %}
                                                                                    {{ vehicle.register_no }}
                                                                                {% endif %}
                                                                                ({{ vehicle.pitb_code }})
                                                                            </option>
                                                                        {% endfor %}
                                                                    </select>
                                                                </div>
                                                            </div>

                                                            <div class="row">
                                                                <div class="mb-2 btn-showcase d-flex gap-2 justify-content-end">
                                                                    <button class="btn btn-success btn-hover-effect"
                                                                            type="submit">
                                                                        <i class="fa-solid fa-search me-1"></i>
                                                                        Apply Filter
                                                                    </button>
                                                                    <a href="javaScript:void(0)"
                                                                       class="btn btn-warning btn-hover-effect">
                                                                        <i class="fa-solid fa-refresh me-1"></i>
                                                                        Reset
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- FILTER INFORMATION -->

                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-12 col-xl-7 box-col-12">
                <div class="card">
                    <div class="card-body z-1 p-0">
                        <div class="default-map-js-height b-r-10" id="create-container-map"></div>
                    </div>
                </div>
            </div>

        </div>

        <div class="row candidate-wrapper">
            <div class="col-12">
                <div class="card">
                    <div class="card-body main-title-box">
                        <div class="common-space gap-2">
                            <h6 class="f-light">
                                Download data in different formats based on filters applied on the page.
                            </h6>
                            <div class="e-common-button">
                                <a class="btn btn-primary"
                                   href="{% url 'export_excel' %}?{% if selected_vehicle_code %}&cmd_vehicle_list={{ selected_vehicle_code }}{% endif %}"
                                        {#                                   href="{% url 'export_excel' %}?{% if seach_term %}vehicle_search={{ seach_term }}{% endif %}{% if selected_vehicle_code %}&cmd_vehicle_list={{ selected_vehicle_code }}{% endif %}{% if filter_vehicle_status %}&vehicle_status={{ filter_vehicle_status }}{% endif %}"#}
                                   target="_blank">
                                    <i class="fa-solid fa-file-excel me-1"></i>
                                    Get Excel
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-12">
                <div class="card">

                    <div class="card-body candidates-box px-0">
                        <div class="table-responsive custom-scrollbar">
                            <table class="table" id="vehicle-monitoring-table">
                                <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Vehicle</th>
                                    <th>System Hierarchy</th>
                                    <th>Location</th>
                                    <th>Device</th>
                                    <th>Duration</th>
                                    <th>Action</th>
                                </tr>
                                </thead>
                                <tbody id="tbody_vehicle_status_datatable">
                                {% for data in vehicle_live_lists %}
                                    <tr>
                                        <th scope="row"
                                            class="xsm-text text-capitalize align-middle">
                                            {{ forloop.counter }}
                                        </th>
                                        <td>
                                            <div class="common-flex align-items-center">
                                                <div class="position-relative">
                                                    <img class="img-fluid rounded-circle"
                                                         src="{% static 'assets/images/legend/vehicle/vehicle.png' %}"
                                                         alt="user">
                                                    <div class="status" style="width: 15px; height: 15px;">
                                                        <div class="inner-dot bg-{% if data.g_status == "Moving" %}success{% elif data.g_status == "Idle" %}info{% elif data.g_status == "Parked" %}warning{% elif data.g_status == "Offline" %}light{% else %}danger{% endif %}"></div>
                                                    </div>
                                                </div>
                                                <div><a class="f-w-500" href="#!">Reg# {{ data.pitb_code }}
                                                    - {{ data.register_no }}</a>
                                                    <p>Chasis# {{ data.chasis_no }}</p>
                                                </div>
                                            </div>
                                            <div class="common-f-start">
                                                <div class="attachment">
                                                    <i class="fa-solid fa-car"></i>
                                                    <span>{{ data.vehicle_type }}</span>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <ul class="candidate-desc">
                                                <li>
                                                    <h6 class="c-light">Administrative: <span
                                                            class="f-14">UC/CC</span>
                                                    </h6>
                                                </li>
                                                <li>
                                                    <h6 class="c-light">Landuse: <span
                                                            class="f-14">Rural/Urban</span>
                                                    </h6>
                                                </li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="educations">
                                                <li>
                                                    <p class="mb-0">Location Time: {{ data.vendor_date_time }}</p>
                                                    <p class="mb-0">Location : {{ data.geo_location }}</p>
                                                </li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="candidate-skill">
                                                <li>
                                                    <p class="mb-2">Device Status :
                                                        <span>{{ data.device_status }}</span>
                                                    </p>
                                                </li>
                                                <li>
                                                    <div class="common-flex">
                                                        <span class="badge badge-light-primary">{{ data.ignition_status }}</span>
                                                        <span class="badge badge-light-warning">{{ data.g_status }}</span>
                                                        <span class="badge badge-light-success">{{ data.speed }}</span>
                                                        <span class="badge badge-light-secondary">{{ data.duration }}</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="candidate-time-info">
                                                <li>
                                                    <p class="mb-2">
                                                        <i class="fa-solid fa-road me-1"></i> Distance:
                                                        <span class="badge bg-primary">{{ data.distance|floatformat:2 }} km</span>
                                                    </p>
                                                </li>
                                                <li>
                                                    <p class="mb-2">
                                                        <i class="fa-solid fa-clock me-1"></i> Working:
                                                        <span class="badge bg-success">{{ data.working_hours }} Hr</span>
                                                    </p>
                                                </li>

                                            </ul>
                                        </td>        <!-- Till Mohid -->

                                        <td>
                                            <div class="d-flex">
                                                <Button class="btn btn-primary" data-bs-toggle="tooltip"
                                                        data-bs-placement="top" data-bs-title="Message"><i
                                                        class="fa-solid fa-envelope"></i></Button>
                                                <Button class="btn btn-success" data-bs-toggle="tooltip"
                                                        data-bs-placement="top" data-bs-title="Approve"><i
                                                        class="fa-solid fa-thumbs-up"></i></Button>
                                                <Button class="btn btn-danger" data-bs-toggle="tooltip"
                                                        data-bs-placement="top" data-bs-title="Reject"><i
                                                        class="fa-solid fa-circle-xmark"></i></Button>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>

        </div>

    </div>
    <!-- Container-fluid Ends-->

{% endblock %}

<!-- Plugins JS start-->
{% block PluginsJS %}

    <script src="{% static "assets/js/datatable/datatables/jquery.dataTables.min.js" %}"></script>
    <script src="{% static "assets/js/datatable/datatables/dataTables.js" %}"></script>
    <script src="{% static "assets/js/datatable/datatables/dataTables.select.js" %}"></script>
    <script src="{% static "assets/js/datatable/datatables/select.bootstrap5.js" %}"></script>
    <script src="{% static "assets/js/datatable/datatables/datatable.custom.js" %}"></script>
    <script src="{% static "assets/js/sweet-alert/sweetalert.min.js" %}"></script>

    <script src="{% static "assets/js/flat-pickr/flatpickr.js" %}"></script>
    <script src="{% static "assets/js/flat-pickr/custom-flatpickr.js" %}"></script>
    <script src="{% static "assets/js/select/bootstrap-select.min.js" %}"></script>
    <script src="{% static "assets/js/tooltip-init.js" %}"></script>

{% endblock %}
<!-- Plugins JS Ends-->

{% block LeafletJS %}
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
            integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
            crossorigin=""></script>
    <script src="{% static 'assets/script/jslib/leaflet/plugins/GoogleMutant/Leaflet.GoogleMutant.js' %}"></script>
    <script src="{% static 'assets/script/jslib/leaflet/plugins/measure/L.MeasuringTool.js' %}"></script>
    <script src="{% static 'assets/script/jslib/leaflet/plugins/PolylineMeasure/Leaflet.PolylineMeasure.js' %}"></script>
    <script src="{% static 'assets/script/jslib/leaflet/plugins/styledLayerControl/styledLayerControl.js' %}"></script>
    <!-- Dependency to Leaflet Draw -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src="https://npmcdn.com/leaflet.path.drag/src/Path.Drag.js"></script>
    <script src="{% static "assets/script/jslib/leaflet/plugins/Editable/Leaflet.Editable.js" %}"></script>
    <script src="{% static "assets/script/jslib/leaflet/plugins/Snap/leaflet.geometryutil.js" %}"></script>
    <script src="{% static "assets/script/jslib/leaflet/plugins/Snap/leaflet.snap.js" %}"></script>

    <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>

{% endblock %}

<!-- Custom JS -->
{% block CustomerJS %}
    <script src="{% static "assets/script/include/DigitalArz.js" %}" type="text/javascript"></script>
    <script src="{% static "assets/script/include/TOCLayerModel.js" %}" type="text/javascript"></script>
    <script src="{% static "assets/app_js/MappingModel.js" %}" type="text/javascript"></script>
    <script src="{% static "assets/app_js/VehicleModel.js" %}" type="text/javascript"></script>
    <script>

        let DigitalArzModelJS = null;
        let TOCLayerModelJS = null;
        let MappingModelJS = null;
        let VehicleModelJS = null;

        let vehicle_live_lists_str = JSON.stringify({{ vehicle_live_lists | safe }});
        let vehicle_live_lists = JSON.parse(vehicle_live_lists_str);

        //// ASSET TYPE WISE URL ////
        let fetch_drum_feature_data = '{% url "FetchDrumFeatureData" %}';
        let fetch_container_feature_data = '{% url "FetchContainerFeatureData" %}';

        let fetch_collection_site_feature_data = '{% url "FetchCollectionSiteData" %}';
        let fetch_dumping_site_feature_data = '{% url "FetchDumpingSiteData" %}';
        let fetch_dumping_coverage_feature_data = '{% url "FetchDumpingCoverageData" %}';
        let fetch_weighing_site_feature_data = '{% url "FetchWeighingSiteData" %}';
        let fetch_weighing_coverage_feature_data = '{% url "FetchWeighingCoverageData" %}';

        //// SYSTEM HIERARCHY URL ////
        let fetch_landuse_boundary_feature_data = '{% url "FetchLanduseBoundaryFeature" %}';
        let fetch_admin_boundary_feature_data = '{% url "FetchAdministrativeBoundaryFeature" %}';
        {#let fetch_union_council_feature_data = '{% url "FetchUnionCouncilFeature" %}';#}
        //// ASSET TYPE WISE URL (END) ////

        let fetch_vehicle_feature_data = '{% url "FetchVehicleFeatureData" %}';
        let fetch_vehicle_live_monitoring_gprs = '{% url "FetchVehicleLiveMonitoringByGPRS" %}';

        let vehicle_list_with_type_code = '{% url "VehicleListWithTypeCode" %}';

        $(document).ready(function () {

            VehicleModelJS = new AppVehicleModel();
            VehicleModelJS.appConstructor();

            //// MAPPING MODEL JS
            DigitalArzModelJS = new AppDigitalArzModel("create-container-map");
            if (DigitalArzModelJS.map === null) {
                DigitalArzModelJS.LoadMap("true", "");
                {#let district_extent = '67.092568,24.917366,74.593624,34.0247';#}
                {#////  THIS FUNCTION IS USED TO ZOOM THE LAYER  /////#}
                {#DigitalArzModelJS.ZoomToFeature("", district_extent);#}

                //// MAPPING MODEL DEFINE
                MappingModelJS = new AppMappingModel();

                //// TOC LAYER MODEL LAYER DEFINE
                TOCLayerModelJS = new AppTOCLayerModel();
                TOCLayerModelJS.appConstructor();

                //// FETCH VEHICLE FEATURE DATA
                TOCLayerModelJS.FetchVehicleFeatureData("Onload", vehicle_live_lists);

                {#//// FETCH VEHICLE LIVE MONITORING BY GPRS DATA#}
                {#TOCLayerModelJS.FetchVehicleLiveMonitoringByGPRS();#}

                {#//// THIS FUNCTION SHOW VEHICLE FEATURE ON MAP#}
                {#VehicleModelJS.ShowVehicleLiveMonitoringMap(vehicle_live_lists);#}

            }

            //// jQuery version
            $('#vehicle_live_label').change(function () {
                if ($(this).is(':checked')) {
                    console.log("Checkbox checked");
                    {#showFeature();  // your custom function#}
                    // Add a class
                    $('#vehicle_live_label_i').removeClass('fa-eye-slash');
                    $('#vehicle_live_label_i').addClass('fa-eye');
                } else {
                    console.log("Checkbox unchecked");
                    {#hideFeature();  // your custom function#}
                    // Remove a class
                    $('#vehicle_live_label_i').removeClass('fa-eye');
                    $('#vehicle_live_label_i').addClass('fa-eye-slash');

                }
            });

            //// ONCHANGE FUNCTION FILL VEHICLE LIST
            $("#cmd_vehicle_type").change(function (e) {
                let selected_value = e.target.value;
                //// FETCH VEHICLE LIST BY VEHICLE TYPE
                VehicleModelJS.VehicleListWithTypeCodeView("cmd_vehicle_list", selected_value, '{{ selected_vehicle_status|safe }}', "");
            });

        }); //// DOCUMENT READY CLOSE

    </script>
{% endblock %}
<!-- End Custom JS -->